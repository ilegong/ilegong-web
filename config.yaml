name: 51daifan
version: 3

handle:
  - rewrite: if (path ~ "^(static|js|css|img|files|api|cache|fonts)/(.*)$") goto "webroot/$1/$2"
  - rewrite: if (path ~ "^manage/(js|css|img|files|fonts)/(.*)$") goto "webroot/$1/$2"
  - rewrite: if (!is_file() && !is_dir() && path ~ "^webroot/cache/(.*)$") goto "saekv.php?k=$1"
  
  - rewrite: if (!is_file() && !is_dir() && path ~ "^manage/(.*)$") goto "manage/index.php?%{QUERY_STRING}"
  - rewrite: if (!is_file() && !is_dir() && path ~ "(.*)") goto "index.php?%{QUERY_STRING}"
  - expire: if(path ~ "\.(js|css|png|gif|jpg|jpeg|bmp|ico)") time 31536000
  - compress: if(out_header["Content-Type"] ~ "(text|javascript|json)") compress
cron:
	- description: send coupons timeout message
	  url: /cron/send_coupon_timeout_message
      schedule: */30 8-22 * * *
      timezone: Beijing
    - description: gen statics order data
      url: /manage/admin/countly/cron_gen_data
      schedule: 0 3 * * *
      timezone: Beijing
    - description: send to comment msg
      url: /cron/send_weshare_order_to_comment_msg
      schedule: 0 12 * * *
      timezone: Beijing
    - description: change order status send comment msg
      url: /cron/change_share_order_status_and_send_msg
      schedule: 0 12 * * *
      timezone: Beijing