(function(e){e.fn.wordLimit=function(a){this.each(function(){if(!a){var t=e(this.cloneNode(true)).hide().css({position:"absolute",width:"auto",overflow:"visible"});e(this).after(t);if(t.width()>e(this).width()){e(this).text(e(this).text().substring(0,e(this).text().length-4));e(this).html(e(this).html()+"...");t.remove();e(this).wordLimit()}else{t.remove();return}}else{var s=a;if(e(this).text().length>s){e(this).text(e(this).text().substring(0,s));e(this).html(e(this).html()+"...")}}})}})(jQuery);$(function(){var e=$("#chat-msg-list");var a=$("#sender-img").val();var t=$("#chat-input-form");var s=$("#sender",t);var r=s.val();var i=$("#receiver",t);var n=$("#share-id",t);var l=n.val();var v=$("#senderName",t);var h=v.val();var c=$("#content",t);var o=$("#btn-chat-submit",t);var f=false;$("#head-share-title").wordLimit(10);d();o.on("click",function(a){a.preventDefault();if(!c.val()){alert("请输入内容");return}var t={receiver:i.val(),share_id:n.val(),msg:c.val()};if(f){alert("正在提交")}f=true;$.post("/share_faq/create_faq/",t,function(a){if(!a["success"]){if(a["reason"]=="user_bad"){alert("你已经被封号，请联系管理员!");f=false}}else{e.append(u(a));c.val("");f=false}},"json")});function u(e){var t='<li class="even"><a class="user" href="/weshares/user_share_info/'+r+'"><img class="img-responsive avatar_" src="'+a+'" alt=""><span class="user-name">'+h+'</span></a> <div class="reply-content-box"> <span class="reply-time">'+e["ShareFaq"]["created"]+'</span> <div class="reply-content pr"> <span class="arrow">&nbsp;</span>'+e["ShareFaq"]["msg"]+"</div></div></li>";return t}function d(){var e="/share_faq/update_faq_read/"+l+"/"+r;$.getJSON(e,function(e){})}});