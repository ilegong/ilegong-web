!function(window,angular){function ShareOptIndexController($rootScope,$http,$log,$q,staticFilePath){function activate(){vm.loadData(vm.bottomTimeStamp).then(function(data){$rootScope.loadingPage=!1},function(data){$rootScope.loadingPage=!1})}function loadNextPage(){return vm.loading||vm.shares.over?!1:(vm.loading=!0,void vm.loadData(vm.bottomTimeStamp).success(function(data){vm.loading=!1}).error(function(data){vm.onLoadedError(),vm.loading=!1}))}function loadData(time){var deferred=$q.defer();return $http.get("/share_opt/fetch_opt_list_data.json?limit=5&type=0&time="+time).success(function(data){data.error&&deferred.reject(data.error);var list=data.opt_logs;_.each(list,function(optLog){vm.bottomTimeStamp=optLog.time}),$log.log(list),vm.shares=vm.shares.concat(list),deferred.resolve(vm.shares)}).error(function(){deferred.reject("Greeting "+name+" is not allowed.")}),deferred.promise}function onLoadedError(){}function getShareImage(share){return _.isEmpty(share)||_.isEmpty(share.images)?vm.staticFilePath+"/static/img/default_product_banner.png":vm.staticFilePath+share.images[0]}var vm=this;vm.staticFilePath=staticFilePath,vm.loadData=loadData,vm.loadNextPage=loadNextPage,vm.onLoadedError=onLoadedError,vm.getShareImage=getShareImage,vm.bottomTimeStamp=0,vm.shares=[],activate()}angular.module("weshares").controller("ShareOptIndexController",ShareOptIndexController)}(window,window.angular);