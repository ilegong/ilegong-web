!function(window,angular){function ShopCtrl($http,$log,$templateCache,$rootScope){function active(){$rootScope.uid=angular.element(document.getElementById("ShopCtrl")).attr("data-user_id"),vm.uid=angular.element(document.getElementById("ShopCtrl")).attr("data-user_id"),vm.sub_status=angular.element(document.getElementById("ShopCtrl")).attr("data-sub_status"),vm.loadData(),$rootScope.loadingPage=!1}function loadData(){vm.loadingData=!0;var url="/weshares/shop_shares/"+vm.uid+"/"+vm.page;$http({method:"GET",url:url,cache:$templateCache}).success(function(data){0==data.length?vm.over=!1:(1==vm.page&&(vm.top[0]=data.shift()),vm.shares=vm.shares.concat(data),vm.page=vm.page+1,vm.loadingData=!1)}).error(function(data,status){})}function setTop(id){vm.loadingData=!0;var url="/weshares/shop_set_top/"+id;$http({method:"GET",url:url,cache:$templateCache}).success(function(data){var tmp=[];tmp[0]=vm.top[0];for(var i=0;i<vm.shares.length;i++)id!=vm.shares[i].Weshare.id?tmp[tmp.length]=vm.shares[i]:vm.top[0]=vm.shares[i];vm.shares=tmp}).error(function(data,status){})}function sub(){vm.loadingData=!0,$http.get("/weshares/subUser/"+vm.uid).success(function(data){data.success?vm.sub_status=1:"not_sub"==data.reason&&(alert("请先关注我们的服务号"),window.location.href=data.url),vm.loadingData=!1}).error(function(){vm.loadingData=!1})}function go(id){id>0&&(window.location.href="/weshares/view/"+id+".html?from=shop")}function showShare(){vm.showShareDialog=!0}function hideShare(){vm.showShareDialog=!1}function msg(){vm.uid>0&&(window.location.href="/share_faq/faq/0/"+vm.uid)}function notice(){vm.loadingData=!0,$http.get("/weshares/notice_from_shop").success(function(data){alert("发送成功"),vm.loadingData=!1}).error(function(){vm.loadingData=!1})}var vm=this;vm.type=1,vm.loadingData=!1,vm.top=[],vm.shares=[],vm.page=1,vm.over=!1,vm.show_desc=!1,vm.showShareDialog=!1,vm.setTop=setTop,vm.sub=sub,vm.loadData=loadData,vm.go=go,vm.showShare=showShare,vm.hideShare=hideShare,vm.msg=msg,vm.notice=notice,active()}angular.module("weshares").controller("ShopCtrl",ShopCtrl)}(window,window.angular);