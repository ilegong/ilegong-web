<div class="weshare-view">
    <ul class="clearfix">
        <li><img ng-src="{{vm.weshare.creator.image}}" /></li>
        <li>
            <label ng-bind="vm.weshare.creator.nickname"></label>
            <s>已有<span ng-bind='vm.ordersDetail.orders.length'></span>人参团  &nbsp;|&nbsp;  <span ng-bind='vm.weshare.created'></span></s>
        </li>
        <li style="float: right;"><a ng-click="vm.showStaticsDialog=true;vm.showLayer=true;">购买统计</a></li>
    </ul>
    <div class="introduction">
        <b></b>
        <div class="status" ng-bind="vm.statusMap[vm.weshare.status]"></div>
        <h1 ng-bind="vm.weshare.title"></h1>
        <s>取货时间: <span ng-bind='vm.weshare.send_info'></span></s>
        <p ng-bind='vm.weshare.description'></p>
        <!--<a href="#X">更多</a>-->
        <dl class="clearfix" ng-repeat="image in vm.weshare.images">
            <dt><a ng-click="vm.viewImage(image)"><img ng-src="{{image}}"/></a></dt>
        </dl>
        <div class="share_tuan_detail products form-group" ng-class="{'has-error':vm.productsHasError}">
            <dl class="clearfix product form-control" ng-repeat="product in vm.weshare.products">
                <dd class="fl" ng-bind="product.name"></dd>
                <dd class="fr">
                    <a class='btn decrease-btn' ng-click="vm.decreaseProductNum(product)"></a>
                    <span class='num' ng-bind="product.num||0"></span>
                    <a class='btn increase-btn' ng-click="vm.increaseProductNum(product)"></a>
                </dd>
                <dd class="fr" style="color: #29AC0E;" ng-bind="product.price/100 | currency:'￥'"></dd>
            </dl>
            <p class='tips'>请输入至少一个商品的数量</p>
        </div>
        <div class="form-group" ng-class="{'has-error': vm.addressHasError}">
            <select class='form-control' ng-model='vm.weshare.selectedAddressId' ng-options="address.id as address.address for address in vm.weshare.addresses" ng-change='vm.validateAddress()'>
                <option value="-1">请选择地址</option>
            </select>
            <p class='tips'>请选择收货地址</p>
        </div>
        <div class='total-fee'>总金额：<span ng-bind="vm.orderTotalPrice | currency:'￥'"></span></div>
    </div>
    <div class="orders">
        <ul class="order clearfix" ng-class="{'my-order': vm.currentUser==order.creator}" ng-repeat="order in vm.ordersDetail.orders">
            <li><img class='buyer-image' ng-src="{{vm.ordersDetail.users[order.creator]['image']}}"/></li>
            <li class="detail">
                <p><strong class='buyer-name' ng-bind="vm.ordersDetail.users[order.creator]['nickname']"></strong> 参加了团购</p>
                <q>{{vm.getOrderDisplayName(order.id)}}</q>
                <span class='created-at' ng-bind="order.created"></span>
            </li>
        </ul>
    </div>
</div>

<a class="btn stop-btn" style="display: none;">已截团</a>
<a class="btn tuan-btn" style="display: none;">截团</a>
<div class="clearfix starttuan_btn">
    <a ng-click="vm.buyProducts()" style="background-color: #ffa200;">我要参团</a>
    <a ng-click="vm.showShareDialog=true;vm.showLayer=true;" style="background-color: #29ac0e;">分享给好友一起团</a>
</div>
<!--支付层-->
<div class="buying-dialog" ng-show="vm.showBuyingDialog">
    <div class="clearfix" style="padding: 5px 10px 0px 10px;">
        <label>输入联系信息</label>
        <a ng-click="vm.showBuyingDialog=false;vm.showLayer=false;" class="closebtn fr"></a>
    </div>
    <div class="clearfix">
        <div class="form-group inline-input" ng-class="{'has-error': vm.usernameHasError}">
            <input placeholder="输入姓名" ng-model='vm.buyerName'/>
            <p class='tips'>请输入收货人</p>
        </div>
        <div class="form-group inline-input" ng-class="{'has-error': vm.buyerMobilePhoneHasError}">
            <input placeholder="输入手机号" ng-model='vm.buyerMobilePhone'/>
            <p class='tips'>请输入正确的手机号</p>
        </div>
    </div>
    <font>支付金额：<span ng-bind="vm.orderTotalPrice | currency:'￥'"></span></font>
    <div class="clearfix starttuan_btn">
        <a ng-click='vm.submitOrder(0);' style="background-color: #29ac0e;">微信支付</a>
        <a ng-click='vm.submitOrder(1);' style="background-color: #ffa200;">支付宝</a>
    </div>
</div>
<!--购买统计-->
<div class="statistics-dialog" ng-show="vm.showStaticsDialog">
    <div ng-repeat="item in vm.ordersDetail.summery.details">
        <ul class="clearfix">
            <li class="fl" ng-bind="item.name"></li>
            <li class="fr">已卖{{item.num}}份</li>
        </ul>
    </div>
    <ul class="clearfix">
        <li class="fl">&nbsp;</li>
        <li class="fr"><strong>金额合计：{{vm.ordersDetail.summery.all_total_price/100 | currency:'￥'}}</strong></li>
    </ul>
</div>
<div class="share-dialog" ng-show="vm.showShareDialog">
    <div style="width: 90%; margin: 0 auto; font-size: 1.3em;">点击右上角“…”，分享给好友或朋友圈。</div>
</div>

<div class="background-layer" ng-show="vm.showLayer" ng-click="vm.showLayer=false;vm.showStaticsDialog=false;vm.showBuyingDialog=false;vm.showShareDialog=false;"></div>
