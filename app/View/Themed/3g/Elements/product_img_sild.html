<div class="p_details_pic">
    <div class="index_banner swiper-container">
        <ul class="clearfix list-unstyled">
        <?php
            $reversedUploadFiles = array_reverse($Product['Uploadfile']);
        ?>
        {{loop $reversedUploadFiles $key $uploadfile}}
            <li {{if $key == 0}}class="cur"{{/if}}></li>
        {{/loop}}
        </ul>
        <div class="swiper-wrapper">
        {{loop $reversedUploadFiles $key $uploadfile}}
            <div class="swiper-slide" style="width: 320px; height: 275px;"><a href="#"><img src="http://51daifan-images.stor.sinaapp.com/{{$uploadfile['Uploadfile']['mid_thumb']}}" border="0"></a></div>
        {{/loop}}
        </div>
    </div>
</div>

{{$this->Html->script(array('swiper/idangerous.swiper-2.0.min.js'), array('block' => 'scriptBottom'));}}


<script>
    $(document).ready(function() {
        var $indexBanner = $('.index_banner');
        var ul = $indexBanner.find('ul');
        var sliderCount = Math.max($('.swiper-slide', $indexBanner).length, 1);
        var mySwiper = $indexBanner.swiper({
            mode: 'horizontal',
            loop: true,
            autoplay: 10000,
            calculateHeight: true,
            onSlideChangeStart: function (swiper) {
                console.log("activeIndex: " + swiper.activeIndex);
                ul.find('li').removeClass('cur');
                ul.find('li:nth-child(' + (swiper.activeLoopIndex % sliderCount + 1 ) + ')').toggleClass('cur');
            }
        });
    });
</script>