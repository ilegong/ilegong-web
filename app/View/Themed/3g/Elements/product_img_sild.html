<div class="p_details_pic">
    <?php
        $uploadFiles = $Product['Uploadfile'];
    ?>
    <div class="index_banner swiper-container hide" data-slider-count="{{count($uploadFiles)}}">
        <ul class="clearfix list-unstyled">
        {{loop $uploadFiles $key $uploadfile}}
            <li {{if $key == 0}}class="cur"{{/if}}  data-key="{{$key}}" data-order="{{$uploadfile['Uploadfile']['sortorder']}}" data-uri="{{$uploadfile['Uploadfile']['mid_thumb']}}"></li>
        {{/loop}}
        </ul>
        <div class="swiper-wrapper">
        {{loop $uploadFiles $key $uploadfile}}
            <div class="swiper-slide" style="width: 320px; height: 275px;">
                <a href="#"><img src="http://51daifan-images.stor.sinaapp.com{{$uploadfile['Uploadfile']['mid_thumb']}}" border="0"></a>
            </div>
        {{/loop}}
        </div>
    </div>
</div>

{{$this->Html->script(array('swiper/idangerous.swiper-2.0.min.js'), array('block' => 'scriptBottom'));}}


<script>
    $(document).ready(function() {
        var $indexBanner = $('.index_banner');
        var ul = $indexBanner.find('ul');
        var sliderCount = $indexBanner.data('slider-count');
        $indexBanner.removeClass('hide');
        var swiper = $indexBanner.swiper({
            mode: 'horizontal',
            loop: true,
            loopedSlides: sliderCount,
            autoplay: 10000,
            calculateHeight: true,
            onSlideChangeStart: function (swiper) {
                ul.find('li').removeClass('cur');
                ul.find('li:nth-child(' + (swiper.activeLoopIndex % sliderCount + 1 ) + ')').addClass('cur');
            }
        });
    });
</script>