<div class="classlist_v2" style="z-index:100">
    <ul class="clearfix">
        <li><a href="{{empty($_GET['history']) ? 'javascript:history.back(-1);':$_GET['history']}}" class="back"></a>
        </li>
        <li class="line"></li>
        <li><strong>完善信息</strong></li>
    </ul>
</div>
<div class="mobile_custom" style="background-color: #f5f5f5;margin-top: 40px;">
    <dl class="clearfix raty" style="margin-bottom: 10px">
        <dt class="comment_star fl">支付方式:</dt>
    </dl>
    <div class="comment comment_bg" style="padding: 0.5em;">
        <div style="position:relative;" name="comment-place">
            <textarea name="userPayment" cols="" rows="2" placeholder="输入支付方式" style="height: auto;"></textarea>
        </div>
    </div>
    <dl class="clearfix raty" style="margin-bottom: 10px">
        <dt class="comment_star fl">个人简介:</dt>
    </dl>
    <div class="comment comment_bg" style="padding: 0.5em;">
        <div style="position:relative;" name="comment-place">
            <textarea name="userDescription" cols="" rows="" placeholder="个人描述" style="height: 120px;"></textarea>
        </div>
    </div>
    <div class="tipslayer" style="display: none;z-index: 300">
        <div class="tipslayer_word"><strong>您还没有给自己描述!</strong><br/>有描述后别人会更好的知道你！</div>
        <ul class="clearfix">
            <li><a href="#X" name="saveUserInfoForce">保存</a></li>
            <li><a href="#X" id="to_add_description" style="border-left: 1px #dddddd solid;">添加描述</a></li>
        </ul>
    </div>
    <div class="tipslayer_bg" style="display: none;z-index: 200"></div>
    <a href="javascript:;" name="saveUserInfo" class="comment_submit">保存</a>
</div>
<script>
    $(document).ready(function(){
        var $userPaymentEl = $('textarea[name="userPayment"]');
        var $userDescriptionEl = $('textarea[name="userDescription"]');
        var $addDescriptionEl = $('#to_add_description');
        var $tipsLayerEl = $('div.tipslayer');
        var $tipslayerBgEl = $('div.tipslayer_bg');
        $('a[name="saveUserInfo"]').on('click',function(){
            var payment = $userPaymentEl.val();
            var description = $userDescriptionEl.val();
            if(!payment||!payment.trim()){
                utils.alert('请输入支付方式');
                return;
            }
            if(!description||!description.trim()){
                $tipsLayerEl.show();
                $tipslayerBgEl.show();
                return;
            }
            handleSaveInfo(payment,description);
        });

        $('a[name="saveUserInfoForce"]').on('click',function(){
            var payment = $userPaymentEl.val();
            var description = $userDescriptionEl.val();
            handleSaveInfo(payment,description);
        });

        $addDescriptionEl.on('click',function(){
            hideLayer();
        });

        $tipslayerBgEl.on('click',function(){
            hideLayer();
        });

        function hideLayer(){
            $tipsLayerEl.hide();
            $tipslayerBgEl.hide();
        }

        function handleSaveInfo(payment,description){
            $.post('/users/complete',{payment:payment,description:description},function(data){
                if(data['success']){
                    
                }else{
                    alert('保存失败');
                }
            },'json');
        }
    });
</script>