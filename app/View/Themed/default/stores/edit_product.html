<div class="container">
<style>
body{
	overflow-x:hidden;
}
</style>
{{$this->Html->css(array('/js/tag_input/jquery.tagsinput.css',))}}
<h2><span class="title">编辑商品</span></h2>

{{$this->Form->create('Product', array('url' => array('controller' => 'stores', 'action'=>'edit_product', $id) , 'class'=>'form-horizontal','role'=>'form'))}}
	<div class="form-group">
		<label class="col-sm-2 control-label" for="ProductName">商品名称</label>
		<div class="col-sm-9 controls">
			{{$this->Form->hidden('id')}}
			{{$this->Form->input('name',array('class'=>'form-control','div'=>false,'label'=>false,'placeholder'=>'最少15个字，最多30个字(3-5个卖点和产品规格 例如:(海南空运“薇薇安”水果千层蛋糕 约1.5磅)'))}}
            <!--<p class="help-block">最多15个字</p>-->
		</div>
	</div>
    <div class="form-group">
		<label class="col-sm-2 control-label" for="ProductPromote">商品名称补充（促销信息）</label>
		<div class="col-sm-9 controls">
			{{$this->Form->input('promote_name',array('class'=>'form-control','div'=>false,'label'=>false))}}
		</div>
	</div>
	<div class="form-group">
		<label class="col-sm-2 control-label" for="ProductPublished">产品首图</label>
		<div class="col-sm-9 controls select">
			<input id="ProductCoverimg" class="form-control" name="data[Product][coverimg]" value="{{$this->data['Product']['coverimg']}}" type="hidden"/>
			<img src="{{$this->data['Product']['coverimg']}}" width="120" id="ProductCoverimgPreview" alt="">
		</div>
	</div>
	<div class="form-group">
		{{$this->Swfupload->load('photo','Product',true)}}
	</div>
	<div class="form-group">
		<label class="col-sm-2 control-label" for="ProductPublished">是否上架</label>
		<div class="col-sm-9 controls select">
			{{$this->Form->input('published',array('class'=>'form-control','type'=>'select','options'=>array('0'=>'否','1'=>'是',),'div'=>false,'label'=>false))}}
		</div>
	</div>
	
	<div class="form-group">
		<label class="col-sm-2 control-label" for="ProductPrice">价格(元)</label>
		<div class="col-sm-9 controls number">
			{{$this->Form->input('price',array('class'=>'form-control','div'=>false,'label'=>false))}}
            <p class="help-block">实际售价</p>
		</div>
	</div>

	<div class="form-group">
		<label class="col-sm-2 control-label" for="ProductOriginalPrice">原价(元)</label>
		<div class="col-sm-9 controls number">
			{{$this->Form->input('original_price',array('class'=>'form-control','div'=>false,'label'=>false))}}
            <p class="help-block">用于显示商品原价或者市场价，不是真实售价</p>
		</div>
	</div>

    <div class="form-group">
        <label class="col-sm-2 control-label" for="ProductShipfee">快递费用(元)</label>
        <div class="col-sm-9 controls number">
            {{$this->Form->input('ship_fee',array('class'=>'form-control','div'=>false,'label'=>false))}}
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-2 control-label" for="ProductSpecs">购买可选项</label>
        <div class="col-sm-9 controls">
            <input type="text"  class="form-control" id="product_tag_name" placeholder="购买可选项">
        </div>
    </div>
    <div class="form-group">
        <input type="hidden" value="" id="product_specs" name="data[Product][specs]" />
        <div class="col-sm-9 controls col-sm-offset-2">
            <input id="spec_tags" type="text" class="tags">
            <p class="help-block">结果<pre id="json_spec_str">{{if $this->data['Product']['specs']}}
{{$this->data['Product']['specs']}}{{else}}
{"map": {}, "choices": { "规格": []}}{{/if}}
        </pre></p>
        </div>
    </div>

	<div class="form-group">
		<label class="col-sm-2 control-label" for="ProductName">商品描述</label>
	</div>

    <div class="form-group">
		<div class="col-sm-12">
			{{$this->Form->input('content',array('class'=>'form-control','div'=>false,'label'=>false,'type'=>'textarea'))}}
		</div>
	</div>
	
	<div class="form-group">
		<div class="col-sm-12"><input class="btn btn-primary" type="submit" value="提交"></div>
	</div>
{{$this->Form->end()}}

{{$this->Html->script(array(
	'ckeditor/ckeditor.js',
	'swfupload/swfupload.js',
	'swfupload/swfupload.queue.js',
	'swfupload/swfupload.cookies.js',
	'swfupload/fileprogress.js',
	'swfupload/handlers.js',
    'tag_input/jquery.tagsinput.min.js',
	'/js/json2.js',
    'product_spec.js?2',
    'jquery.validate.min.js',
	'store.js',
))}}
<script>
$(function(){
	CKEDITOR.editorConfig = function( config ){
		config.toolbar = 'FRONT';
	}
	ckeditors['ProductContent'] = CKEDITOR.replace( 'ProductContent',
		    {
		        customConfig : '{{$this->Html->assetUrl("/js/ckeditor/front-config.js")}}'
		    });
	ckeditors['ProductContent'].on('focus',function(e){
		current_ckeditor_instance = e.editor;
	});
	

	CKEDITOR.on( 'instanceReady', function( e ){
		e.editor.document.appendStyleSheet( '{{$this->Html->assetUrl("/stylevars/getcss.css")}}' );
		e.editor.document.appendStyleSheet( '{{$this->Html->assetUrl("/css/ui-customer.css")}}' );
		//e.editor.setMode( 'source' );
		e.editor.on( 'mode', function( e ){
			if(e.editor.mode == 'wysiwyg'){
				e.editor.document.appendStyleSheet( '{{$this->Html->assetUrl("/stylevars/getcss.css")}}' );
				e.editor.document.appendStyleSheet( '{{$this->Html->assetUrl("/css/ui-customer.css")}}' );
			}
		});
	});

    $('#ProductEditProductForm').validate({
        rules:{
            ProductName:{
                required:true,
                rangelength:[15,30]
            }
        },
        messages:{
            ProductName:{required:'标题不能为空哦',rangelength:'最少15个字，最多30个字(3-5个卖点和产品规格 例如:(海南空运“薇薇安”水果千层蛋糕 约1.5磅)'}
        }

    })
})
</script>
</div>