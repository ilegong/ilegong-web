{{$this->Html->css(array('/js/tag_input/jquery.tagsinput.css','/js/handsontable/handsontable.full.min.css'))}}
<div class="container">
    <style>
        body {
            overflow-x: hidden;
        }

        .entry:not(:first-of-type) {
            margin-top: 10px;
        }

        .glyphicon {
            font-size: 12px;
        }
    </style>
    <h2><span class="title">发布商品</span></h2>

    <form accept-charset="utf-8" role="form" class="form-horizontal" method="post" id="ProductAddForm"
          action="{{$this->Html->url('/s/add_product.html')}}">
        <div class="form-group">
            <label class="col-sm-2 control-label" for="ProductName">商品名称</label>

            <div class="col-sm-9 controls">
                <input type="text" value="{{$this->data[Product][name]}}" class="form-control" id="ProductName"
                       maxlength="250" name="data[Product][name]" placeholder="最少15个字，最多30个字(3-5个卖点和产品规格 例如:(海南空运“薇薇安”水果千层蛋糕 约1.5磅)">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="promote_name">商品名称补充（促销信息）</label>

            <div class="col-sm-9 controls select">
                <input type="text" id="promote_name" value="{{$this->data[Product][promote_name]}}" class="form-control"
                       name="data[Product][promote_name]"/>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" for="ProductPublished">是否上架</label>

            <div class="col-sm-9 controls select">
                <select id="ProductPublished" class="form-control" name="data[Product][published]">
                    <option value="0">否</option>
                    <option value="1">是</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label" for="ProductPublished">产品首图</label>
            <div class="col-sm-9 controls select">
                <input id="ProductCoverimg" class="form-control" name="data[Product][coverimg]" type="hidden"/>
                <img src="/img/nophoto.gif" width="120" id="ProductCoverimgPreview" alt="">
            </div>
        </div>

        <div class="form-group">
            <!--<label class="col-sm-2 control-label" for="ProductPublished">封面图片</label>-->

            <div class="col-sm-9 controls select">
                {{$this->Swfupload->load('photo','Product',true)}}
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label" for="ProductPrice">价格(元)</label>

            <div class="col-sm-9 controls number">
                <input type="number" id="ProductPrice"
                       value="{{$this->Number->precision($this->data[Product][price], 2)}}" step="any"
                       class="form-control" name="data[Product][price]">

                <p class="help-block">实际售价</p>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label" for="ProductOriginPrice">原价(元)</label>

            <div class="col-sm-9 controls number">
                <input type="number" id="ProductOriginPrice"
                       value="{{$this->Number->precision($this->data[Product][original_price], 2)}}" step="any"
                       class="form-control" name="data[Product][original_price]">

                <p class="help-block">用于显示商品原价或者市场价，不是真实售价</p>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label" for="ProductShipfee">快递费用(元)</label>

            <div class="col-sm-9 controls number">
                <input type="number" id="ProductShipfee"
                       value="{{$this->Number->precision($this->data[Product][ship_fee], 2)}}" step="any"
                       class="form-control" name="data[Product][ship_fee]">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-2 control-label" >购买可选项</label>
            <div class="col-sm-3 controls" name="spec-tag">
                <div class="col-xs-8">
                    <select class="form-control" name="spec-1">

                    </select>
                </div>
                <br/>
                <br/>
                <input type="text" name="tags-1">
            </div>
            <div class="col-sm-3 controls" name="spec-tag">
                <div class="col-xs-8">
                    <select class="form-control" name="spec-2">

                    </select>
                </div>
                <br/>
                <br/>
                <input type="text" name="tags-2">
            </div>
            <div class="col-sm-3 controls" name="spec-tag">
                <div class="col-xs-8">
                    <select class="form-control" name="spec-3">

                    </select>
                </div>
                <br/>
                <br/>
                <input type="text" name="tags-3">
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-9 controls col-sm-offset-2">
                <div id="spec_table">

                </div>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-2 control-label" for="ProductName">商品描述</label>
            <div class="col-sm-9">
                <textarea id="ProductContent" class="form-control" cols="30" rows="4" name="data[Product][content]">{{$this->data[Product][content]}}</textarea>
            </div>
        </div>

        <input type="hidden" id="spec_table_data" name="spec_table"/>

        <div class="form-group">
            <div class="col-sm-9 col-sm-offset-2"><input id="submit-btn" class="btn btn-primary" type="submit" value="提交"></div>
        </div>
    </form>

    <script>
        var all_product_attrs = JSON.parse('{{$product_attrs}}');
        var product_specs=[];
        var should_init = false;
    </script>

    {{$this->Html->script(array(
    'ckeditor/ckeditor.js',
    'swfupload/swfupload.js',
    'swfupload/swfupload.queue.js',
    'swfupload/swfupload.cookies.js',
    'swfupload/fileprogress.js',
    'swfupload/handlers.js',
    'tag_input/jquery.tagsinput.min.js',
    '/js/handsontable/handsontable.full.min.js',
    '/js/json2.js',
    'jquery.validate.min.js',
    'store.js?v1',
    'edit_product_spec.js',
    ))}}

    <script>
        $(function () {
            CKEDITOR.editorConfig = function (config) {
                config.toolbar = 'FRONT';
            }
            ckeditors['ProductContent'] = CKEDITOR.replace('ProductContent',
                    {
                        customConfig: '{{$this->Html->assetUrl("/js/ckeditor/front-config.js")}}'
                    });
            ckeditors['ProductContent'].on('focus', function (e) {
                current_ckeditor_instance = e.editor;
            });


            CKEDITOR.on('instanceReady', function (e) {
                e.editor.document.appendStyleSheet('{{$this->Html->assetUrl("/stylevars/getcss.css")}}');
                e.editor.document.appendStyleSheet('{{$this->Html->assetUrl("/css/ui-customer.css")}}');
                //e.editor.setMode( 'source' );
                e.editor.on('mode', function (e) {
                    if (e.editor.mode == 'wysiwyg') {
                        e.editor.document.appendStyleSheet('{{$this->Html->assetUrl("/stylevars/getcss.css")}}');
                        e.editor.document.appendStyleSheet('{{$this->Html->assetUrl("/css/ui-customer.css")}}');
                    }
                });
                //if($('.cke_top').parent('ui-dialog-content').size()<1){
                //	$('.cke_top').addClass('clearfix').affix();
                //}
            });
            $('#ProductAddForm').validate({
                rules:{
                    ProductName:{
                        required:true,
                        rangelength:[15,30]
                    }
                },
                messages:{
                    ProductName:{required:'标题不能为空哦',rangelength:'最少15个字，最多30个字(3-5个卖点和产品规格 例如:(海南空运“薇薇安”水果千层蛋糕 约1.5磅)'}
                }

            })

        })
    </script>
</div>